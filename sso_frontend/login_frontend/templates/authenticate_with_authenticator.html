{% extends "base.html" %}

{% block header %}
<script src="/static/js/otp.js" type="text/javascript"></script>
{% endblock %}


{% block content %}
<div class="row">
<div class="col-md-8 col-centered">

{% if invalid_otp %}
<div class="alert alert-danger">
Incorrect one-time code.
</div>

<p>You're authenticating with Authenticator password. You should enter 6-digit one-time password from your mobile app.
If code from your app is not working, you can <a href="{% url 'login_frontend.views.authenticate_with_sms' %}?{{ get_params }}">sign in with SMS</a>.</p>
{% endif %}

{% if message %}
	<div class="alert alert-warning">
               {{ message }}
	</div>
{% endif %}


<form role="form" name="loginform" method="POST" action="{% url 'login_frontend.views.authenticate_with_authenticator' %}?{{ get_params }}">
  {% csrf_token %}
  <div class="form-group control-group">
    <label for="id_otp" control-label">OTP</label>
    <input class="form-control" id="id_otp" placeholder="Please enter numeric OTP" title="You should enter 6-digit one-time password here." name="otp" type="tel" data-len="5-6" pattern="[0-9 ]*" autocomplete='off' />
    <span class="glyphicon form-control-feedback"></span>
  </div>
  <div class="form-group">
       <button class="btn btn-large btn-primary" type="submit">Sign in <span class="glyphicon glyphicon-remove-circle"></span></button>
  </div>
  <div class="form-group">
      <div class="checkbox">
        <label>
          <input name="my_computer" type="checkbox"> Remember me on this computer
        </label>
      </div>
  </div>
</form>
<p><small>Problems with Authenticator app? <a href="{% url 'login_frontend.views.authenticate_with_sms' %}?{{ get_params }}">Authenticate with SMS</a>.</small></p>
</div>
</div>



{% endblock %}
