{% extends "base.html" %}

{% block header %}
<script src="/static/js/otp.js" type="text/javascript"></script>
{% endblock %}


{% block content %}
<div class="row">
<div class="col-md-8 col-centered">

{% if primary_phone_changed %}
<div class="alert alert-warning">
Your phone number has changed. For security reasons, you must reconfigure strong authentication.
</div>

<p>You should receive SMS message with one-time password #{{ expected_sms_id }} shortly. Please enter the code below. On the next step, you can set your preferences for authentication. After that, you'll be redirected back to service you tried to access.</p>

{% elif strong_not_configured %}
<div class="alert alert-warning">
You have not configured strong authentication.
</div>

<p>You should receive SMS message with one-time password #{{ expected_sms_id }} shortly. Please enter it below. On the next step, you can set your preferences for authentication. After that, you'll be redirected back to service you tried to access.</p>

<p><a target="_window" href="{% url 'introduction' %}">What is strong authentication?</a></p>
{% elif authentication_failed %}
<div class="alert alert-danger">
Incorrect one-time code.
</div>

<p>You're authenticating with SMS code. You should enter 5-digit code #{{ expected_sms_id }}. Older messages are not valid anymore. If you have Authenticator app installed and configured, you can enter one-time code from there.</p>
{% else %}
You should receive SMS containing one-time password shortly. Please enter it below. It should be #{{ expected_sms_id }}.
{% endif %}

<form role="form" name="loginform" method="POST" action="{% url 'login_frontend.views.authenticate_with_sms' %}?{{ get_params }}">
  {% csrf_token %}
  <div class="form-group control-group">
    <label for="id_otp" control-label">OTP</label>
    <input class="form-control" id="id_otp" placeholder="Please enter numeric OTP" title="You should enter 6-digit one-time password here." name="otp" type="tel" data-len="5-6" pattern="[0-9 ]*" autocomplete='off' />
    <span class="glyphicon form-control-feedback"></span>
  </div>
  <div class="form-group">
       <button class="btn btn-large btn-primary" type="submit">Sign in <span class="glyphicon glyphicon-remove-circle"></span></button>
  </div>
  <div class="form-group">
      <div class="checkbox">
        <label>
          <input name="my_computer" type="checkbox"> Remember me on this computer
        </label>
      </div>
  </div>
</form>

<p><small>Want to <a href="{% url 'login_frontend.views.authenticate_with_authenticator' %}?{{ get_params }}">use Authenticator</a> instead of SMS?</small></p>

{% endblock %}
